

# SSL/TLSの概要




## 全体アーキテクチャ



wolfSSL(以前のCyassl)が埋め込まれたSSLライブラリは、SSL 3.0、TLS 1.0、TLS 1.1、TLS 1.2、およびTLS 1.3プロトコルを実装しています。TLS 1.3は現在、標準の最も安全で最新のバージョンです。wolfSSLは、数年間不安定であるという事実により、SSL 2.0をサポートしていません。


WOLFSSLのTLSプロトコルは、[RFC 5246 (https://tools.ietf.org/html/rfc5246).](https://tools.ietf.org/html/rfc5246)で定義されているとおりに実装されています.2つのレコードレイヤプロトコルがSSL内に存在します。ハンドシェイクメッセージは、共通の暗号スイートをネゴシエートし、秘密を作成し、安全な接続を有効にするために使用されます。メッセージレイヤは、アラート処理およびアプリケーションデータ転送をサポートしながらハンドシェイクレイヤをカプセル化する。


SSLプロトコルが既存のプロトコルにどのように適合するかについての一般的な図は、**図1**に表示されます。SSLは、OSIモデルの輸送層とアプリケーション層の間にあり、任意の数のプロトコル(TCP/IP、Bluetoothなどを含む)が輸送媒体として機能する場合があります。アプリケーションプロトコルは、SSL(HTTP、FTP、SMTPなど)の上に階層化されています。

![SSL Protocol Diagram](sslprotocol.png "SSL Protocol Diagram")




## SSLハンドシェイク



SSLハンドシェイクには、SSLクライアントとサーバーが構成されているオプションに応じて、いくつかのステップがオプションです。以下、**図2**では、SSLハンドシェイクプロセスの簡略図があります。

![SSL Handshake Diagram](sslhandshake.png "SSL Handshake Diagram")




## SSLプロトコルバージョンとTLSプロトコルバージョンの違い



SSL(Secure Sockets Layer)とTLS(トランスポートセキュリティレイヤ)は、両方ともネットワーク経由で安全な通信を提供する暗号プロトコルです。これら2つのプロトコル(およびそれぞれのバージョン)は、Webブラウジングから電子メールへの範囲のアプリケーションで、インスタントメッセージングとVoIPへのアプリケーションでは、今日広く使用されています。各プロトコル、およびそれぞれの基礎となるバージョンは、もう一方のプロトコルとは少し異なります。


下には、さまざまなSSLおよびTLSプロトコルバージョンの説明との両方の違いがあります。各プロトコルの詳細については、記載されているRFC仕様を参照してください。



### SSL 3.0




このプロトコルは1996年にリリースされましたが、Netscapeによって開発されたSSL 1.0の作成から始まりました。バージョン1.0はリリースされておらず、バージョン2.0には多くのセキュリティ上の欠陥があり、SSL 3.0のリリースにつながりました。SSL 2.0を超えるSSL 3.0のいくつかの大きな改善は次のとおりです。



* メッセージ層からのデータ転送の分離


* Export Cipherを使用している場合でも、128ビットのキーイングマテリアルを使用する


* クライアントとサーバーが証明書のチェーンを送信する能力により、組織は2つ以上の証明書の証明書階層を使用できるようにします。


* 一般化された鍵交換プロトコルを実装し、Diffie-HellmanとFortezzaの鍵交換と非RSA証明書を許可しています。


* 記録的な圧縮と減圧を可能にします


* 2.0クライアントが見つかったときにSSL 2.0に戻る機能




### TLS 1.0




このプロトコルは1999年1月にRFC 2246で最初に定義されています。これはSSL 3.0からのアップグレードであり、その違いは劇的ではありませんでしたが、SSL 3.0とTLS 1.0は相互運用しないで十分に重要です。SSL 3.0とTLS 1.0の間の大きな違いの一部は次のとおりです。



* キー導出関数は異なります


* Macは異なります-SSL 3.0は初期HMACの変更を使用し、TLS 1.0はHMACを使用します。


* 完成したメッセージは異なります


* TLSにはより警告があります


* TLSにはDSS/DHサポートが必要です




### TLS 1.1




このプロトコルは、2006年4月にRFC 4346で定義され、TLS 1.0の更新です。主な変更は次のとおりです。



* 暗黙の初期化ベクトル(IV)は、暗号ブロック連鎖(CBC)攻撃から保護するために明示的なIVに置き換えられます。


* PADDEDエラーの取り扱いは、CBC攻撃から保護するために`decryption_failed`アラートではなく`bad_record_ma`Cアラートを使用するために変更されます。


* IANAレジストリは、プロトコルパラメーター用に定義されています


* 早期閉鎖は、セッションを復活させなくなりなくなりました。




### TLS 1.2




このプロトコルは2008年8月にRFC 5246で定義されています.TLS 1.1に基づいて、TLS 1.2に基づいて、柔軟性が向上しました。主な違いは次のとおりです。



* 擬似ランダム関数(PRF)のMD5/SHA-1の組み合わせを、暗号スイート指定PRFに置き換えました。


* デジタル署名要素のMD5/SHA-1の組み合わせは、単一のハッシュに置き換えられました。署名された要素には、使用されるハッシュアルゴリズムを明示的に指定するフィールドが含まれます。


* クライアントとサーバーが受け入れるハッシュおよび署名アルゴリズムを指定する能力にかなりのクリーンアップがありました。


* 追加のデータモードを使用した認証された暗号化のためのサポートの追加。


* TLS拡張機能の定義とAES暗号スイートがマージされました。


* EncryptedPremasterSecretバージョン番号の厳しいチェック。


* 多くの要件が厳しくなりました


* `Verify_data`長さは暗号スイートに依存します


* Bleichenbacher/DLIMA攻撃防御の説明が清掃されました。




### TLS 1.3




このプロトコルは、2018年8月にRFC 8446で定義されています.TLS 1.3には、セキュリティとスピードが向上しました。主な違いは次のとおりです。



* サポートされている対称アルゴリズムのリストは、すべての従来のアルゴリズムから整理されました。残りのアルゴリズムはすべて、関連するデータ(AEAD)アルゴリズムを使用して認証された暗号化を使用します。


* ゼロRTT(0-RTT)モードが追加され、特定のセキュリティプロパティをコストでいくつかのアプリケーションデータの接続セットアップで往復を保存しました。


* ServerHelloが暗号化された後のすべてのハンドシェイクメッセージ。


* HMACベースの抽出および拡張鍵導出機能(HKDF)がプリミティブとして使用されているため、鍵導出機能が再設計されました。


* 握手状態のマシンは、より一貫性があり、余分なメッセージを削除するように再ビルドされています。


* ECCは現在、ベーススペックにあり、新しい署名アルゴリズムが含まれています。各曲線のシングルポイント形式を支持して、ポイント形式のネゴシエーションが削除されました。


* 圧縮、カスタムDHEグループ、およびDSAが削除されました、RSAパディングは現在PSSを使用します。


* TLS 1.2バージョンネゴシエーション検証メカニズムは、拡張子のバージョンリストを支持して非推奨を受けました。


* サーバー側の状態の有無にかかわらず、TLSの以前のバージョンのPSKベースのCiphersuitesの場合とないセッション再開は、単一の新しいPSK交換に置き換えられました。
